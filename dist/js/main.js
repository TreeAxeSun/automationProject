"use strict";var level=1;document.getElementById("level").innerHTML=level;var highestLevel=1;document.getElementById("highestLevel").innerHTML=highestLevel;var Enemy=function(e,t,n){this.x=e,this.y=t,this.speed=n,this.sprite="dist/img/enemy-bug.png"};Enemy.prototype.update=function(e){this.x<505?(this.x=this.x+this.speed*e,this.x<player.x+40&&this.x+60>player.x&&this.y<player.y+60&&this.y+40>player.y&&(level=1,document.getElementById("level").innerHTML=level,this.speed=100,restart()),player.y<10&&(this.x=this.x+(this.speed=1.1*this.speed)*e)):this.x=-100,this.x<player.x+40&&this.x+60>player.x&&this.y<player.y+60&&this.y+40>player.y&&(level=1,document.getElementById("level").innerHTML=level,this.speed=70,restart())},Enemy.prototype.render=function(){ctx.drawImage(Resources.get(this.sprite),this.x,this.y)};var Player=function(){this.x=200,this.y=440,this.sprite="dist/img/char-cat-girl.png"};Player.prototype.update=function(){player.y<10&&(level=++level,document.getElementById("level").innerHTML=level,highestLevel<level&&(highestLevel+=1,document.getElementById("highestLevel").innerHTML=highestLevel),restart(),setTimeout(function(){11===level&&(alert("finish"),location.reload())},300))},Player.prototype.render=function(){ctx.drawImage(Resources.get(this.sprite),this.x,this.y)},Player.prototype.handleInput=function(e){"left"==e&&0<this.x&&(this.x-=50),"right"==e&&this.x<400&&(this.x+=50),"up"==e&&1<this.y&&(this.y-=50),"down"==e&&this.y<400&&(this.y+=50)},restart=function(){player.x=200,player.y=440};var Enemy1=function(e,t,n){Enemy.call(this,e,t,n)},Enemy2=function(e,t,n){Enemy.call(this,e,t,n)},Enemy3=function(e,t,n){Enemy.call(this,e,t,n)},Enemy4=function(e,t,n){Enemy.call(this,e,t,n)};Enemy1.prototype=Object.create(Enemy.prototype),Enemy1.prototype.constructor=Enemy1,Enemy2.prototype=Object.create(Enemy.prototype),Enemy2.prototype.constructor=Enemy2,Enemy3.prototype=Object.create(Enemy.prototype),Enemy3.prototype.constructor=Enemy3,Enemy4.prototype=Object.create(Enemy.prototype),Enemy4.prototype.constructor=Enemy4;var enemy1=new Enemy1(-400,60,100),enemy2=new Enemy(-100,140,80),enemy3=new Enemy(-200,220,90),enemy4=new Enemy(-300,310,70),allEnemies=[enemy1,enemy2,enemy3,enemy4],player=new Player;document.addEventListener("keyup",function(e){player.handleInput({37:"left",38:"up",39:"right",40:"down"}[e.keyCode])});var Engine=function(e){var n,t=e.document,r=e.window,i=t.createElement("canvas"),o=i.getContext("2d");function s(){var t,e=Date.now();t=(e-n)/1e3,allEnemies.forEach(function(e){e.update(t)}),player.update(),function(){var e,t,n=["dist/img/water-block.png","dist/img/stone-block.png","dis/img/stone-block.png","dist/img/stone-block.png","dist/img/grass-block.png","dist/img/grass-block.png"];for(o.clearRect(0,0,i.width,i.height),e=0;e<6;e++)for(t=0;t<5;t++)o.drawImage(Resources.get(n[e]),101*t,83*e);allEnemies.forEach(function(e){e.render()}),player.render()}(),n=e,r.requestAnimationFrame(s)}i.width=505,i.height=606,t.body.appendChild(i),Resources.load(["dist/img/stone-block.png","dist/img/water-block.png","dist/img/grass-block.png","dist/img/enemy-bug.png","dist/img/char-cat-girl.png"]),Resources.onReady(function(){n=Date.now(),s()}),e.ctx=o}(void 0);!function(){var n={},r=[];function t(e){if(n[e])return n[e];var t=new Image;t.onload=function(){n[e]=t,i()&&r.forEach(function(e){e()})},n[e]=!1,t.src=e}function i(){var e=!0;for(var t in n)n.hasOwnProperty(t)&&!n[t]&&(e=!1);return e}window.Resources={load:function(e){e instanceof Array?e.forEach(function(e){t(e)}):t(e)},get:function(e){return n[e]},onReady:function(e){r.push(e)},isReady:i}}();